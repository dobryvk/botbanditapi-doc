
# документация botbandit api

## список методов:

1. [init.php](#init) — нужен для получения основной информации об аккаунте на старте приложения. также служит для обработки #-информации (скам);
2. [update-menu.php](#update-menu)   — нужен для получения информации в меню приложения;
3. [get-daily-bonus.php](#get-daily-bonus)   — вызывается, когда пользователь нажимает на кнопку получения ежедневного бонуса;
4. [get-scam-info.php](#get-scam-info)   — вызывается, когда пользователь заходит в меню скама;
5. [get-jackpot-info.php](#get-jackpot-info)  — получить информацию о текущем состоянии джекпот рулетки;
6. [jackpot-bet.php](#jackpot-bet)  — поставить ставку в джекпот рулетке;
7. [get-jackpot-result.php](#get-jackpot-result)  — получить результат джекпот рулетки;
8. [pay-salary.php](#pay-salary)  — выплата зарплаты админам (для разраба админ-бота);

## общие ошибки и то, как следует их обрабатывать

|ошибка|описание|обработка|
|--|--|--|
|code 0 *(security error)*|хэш не прошёл проверку|следует отправить соответствующее сообщение в console.log|
|code 1 *(account not registered)*|аккаунт не зарегистирован|следует показать окно с предложением зарегистрироваться|
|code 2 *(account has been banned)*|аккаунт забанен|следует показать окно с баном|
|code 10000 *(unknown error)*|неизвестная ошибка|следует отправить соответствующее сообщение в console.log|


пример ответа с ошибкой:

    {
		"error": "security error",
		"errno": 0
    }

## методы api

<a name="init"></a>
### init.php

нужен для получения основной информации об аккаунте на старте приложения. также служит для обработки #-информации (скам).

|параметр|описание|
|--|--|
|url|url с которым запустилось приложение **(string)**|
|scammer_id|id скамера, если было передано при старте **(int, optional)**|

пример запроса:

    {
		"url": "https://site.com/?vk_user_id=494075&vk_app_id=6736218&vk_is_app_user=1&vk_are_notifications_enabled=1&vk_language=ru&vk_access_token_settings=&vk_platform=android&sign=t4WeyGcuTMSnKECxnjaBQrPBJgw3xNHzky7NcXyTcgI"
    }

|возвращаемое значение|описание|
|--|--|
|id|vkid пользователя **(int)**|
|money|количество денег у пользователя **(int)**|
|sex|пол пользователя. 1 - парень, 0 - девушка **(int)**|
|last_daily_bonus|может ли получить игрок ежедневный бонус **(bool)**|

пример ответа:

    {
		"id": 656739737,
		"money": 150000,
		"sex": 1,
		"last_daily_bonus": 1625910061
    }

<a name="update-menu"></a>
### update-menu.php

нужен для получения информации в меню приложения.

|параметр|описание|
|--|--|
|url|url с которым запустилось приложение **(string)**|

пример запроса:

    {
		"url": "https://site.com/?vk_user_id=494075&vk_app_id=6736218&vk_is_app_user=1&vk_are_notifications_enabled=1&vk_language=ru&vk_access_token_settings=&vk_platform=android&sign=t4WeyGcuTMSnKECxnjaBQrPBJgw3xNHzky7NcXyTcgI"
    }

|возвращаемое значение|описание|
|--|--|
|id|vkid пользователя **(int)**|
|money|количество денег у пользователя **(int)**|
|last_daily_bonus|unix-время, когда последний раз пользователь забирал ежедневных бонус **(int)**|

пример ответа:

    {
		"id": 656739737,
		"money": 150000,
		"last_daily_bonus": 1625910061
    }

<a name="get-daily-bonus"></a>
### get-daily-bonus.php

вызывается, когда пользователь нажимает на кнопку получения ежедневного бонуса

|параметр|описание|
|--|--|
|url|url с которым запустилось приложение **(string)**|

пример запроса:

    {
		"url": "https://site.com/?vk_user_id=494075&vk_app_id=6736218&vk_is_app_user=1&vk_are_notifications_enabled=1&vk_language=ru&vk_access_token_settings=&vk_platform=android&sign=t4WeyGcuTMSnKECxnjaBQrPBJgw3xNHzky7NcXyTcgI"
    }

|возвращаемое значение|описание|
|--|--|
|id|vkid пользователя **(int)**|
|responce|результат **(string)**|
|last_daily_bonus|unix-время, когда последний раз пользователь забирал ежедневных бонус **(int)**|

варианты **responce**:
 - ok
 - limit have not passed

пример ответа:

    {
		"id": 656739737,
		"responce": "ok",
		"last_daily_bonus": 1625910061
    }

<a name="get-scam-info"></a>
### get-scam-info.php

вызывается, когда пользователь заходит в меню скама.

|параметр|описание|
|--|--|
|url|url с которым запустилось приложение **(string)**|

пример запроса:

    {
		"url": "https://site.com/?vk_user_id=494075&vk_app_id=6736218&vk_is_app_user=1&vk_are_notifications_enabled=1&vk_language=ru&vk_access_token_settings=&vk_platform=android&sign=t4WeyGcuTMSnKECxnjaBQrPBJgw3xNHzky7NcXyTcgI"
    }

|возвращаемое значение|описание|
|--|--|
|id|vkid пользователя **(int)**|
|scam_sum|общая сумма скама **(int)**|
|mamonts_count|количество мамонтов **(int)**|
|mamonts|массив мамонтов **(array)**|
|top|массив топ-скамеров **(array)**|


описание элементов массива **mamonts**:
|поле|описание|
|--|--|
|id|vkid мамонта **(int)**|
|type|тип описания скама **(int)**|
|sum|сумма скама **(int)**|

описание элементов массива **top**:
|поле|описание|
|--|--|
|id|vkid мамонта **(int)**|
|top|место в топе **(int)**|
|sum|общая сумма скама пользователя **(int)**|

пример ответа:

    {
		"id": 656739737,
		"scam_sum": 10200000,
		"mamonts_count": 2,
		"mamonts": 
		[
			{
				"id": 1000001,
				"type": 1,
				"sum": 5200000
			},
			{
				"id": 1000002,
				"type": 2,
				"sum": 5000000
			}
		],
		"top":
		[
			{
				"id": 1000010,
				"top": 1,
				"sum": 300000000000
			},
			{
				"id": 1000011,
				"top": 2,
				"sum": 200000000000
			},
			{
				"id": 1000012,
				"top": 3,
				"sum": 100000000000
			}
		]
    }

<a name="get-jackpot-info"></a>
### get-jackpot-info.php

вызывается каждую секунду, когда пользователь находится в джекпот рулетке, пока не кончается таймер розыгрыша. получает информацию о текущем состоянии джекпот рулетки.

|параметр|описание|
|--|--|
|url|url с которым запустилось приложение **(string)**|

пример запроса:

    {
		"url": "https://site.com/?vk_user_id=494075&vk_app_id=6736218&vk_is_app_user=1&vk_are_notifications_enabled=1&vk_language=ru&vk_access_token_settings=&vk_platform=android&sign=t4WeyGcuTMSnKECxnjaBQrPBJgw3xNHzky7NcXyTcgI"
    }

|возвращаемое значение|описание|
|--|--|
|id|vkid пользователя **(int)**|
|money|количество денег у пользователя **(int)**|
|bet|ставка пользователя **(int)**|
|pot|банк **(int)**|
|players_count|количество игроков **(int)**|
|start_time|время старта розыгрыша в unix **(int)**|
|chance|шанс выигрыша пользователя **(double)**|
|players|массив игроков для рулетки **(array)**|

пример ответа:

    {
	    "id": 128334940,
	    "money": 26005299997,
	    "bet": 50000,
	    "pot": 60000,
	    "players_count": 2,
	    "start": 1630251438,
	    "chance": 83.33,
	    "players": [128334940,123,123,123,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940]
    }

<a name="jackpot-bet"></a>
### jackpot-bet.php

вызывается когда пользователь ставит ставку в джекпот рулетке. получает информацию о текущем состоянии джекпот рулетки.

|параметр|описание|
|--|--|
|url|url с которым запустилось приложение **(string)**|
|bet|сумма ставки **(int)**|

пример запроса:

    {
		"url": "https://site.com/?vk_user_id=494075&vk_app_id=6736218&vk_is_app_user=1&vk_are_notifications_enabled=1&vk_language=ru&vk_access_token_settings=&vk_platform=android&sign=t4WeyGcuTMSnKECxnjaBQrPBJgw3xNHzky7NcXyTcgI",
		"bet": 10000
    }

|возвращаемое значение|описание|
|--|--|
|id|vkid пользователя **(int)**|
|responce|результат ставки **(string)**|
|money|количество денег у пользователя **(int)**|
|bet|ставка пользователя **(int)**|
|pot|банк **(int)**|
|players_count|количество игроков **(int)**|
|start|время старта розыгрыша в unix **(int)**|
|chance|шанс выигрыша пользователя **(double)**|
|players|массив игроков для рулетки **(array)**|

варианты **responce**:
 - ok
 - not enough money

пример ответа:

    {
	    "id": 128334940,
	    "responce": "ok",
	    "money": 26005299997,
	    "bet": 50000,
	    "pot": 60000,
	    "players_count": 2,
	    "start": 1630251438,
	    "chance": 83.33,
	    "players": [128334940,123,123,123,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940]
    }
|ошибка|описание|обработка|
|--|--|--|
|code 700 *(invalid bet)*|неправильно указан параметр **bet**|следует отправить соответствующее сообщение в console.log|


<a name="get-jackpot-result"></a>
### get-jackpot-result.php

вызывается когда таймер рулетки подошёл к концу. в это время нельзя вызывать **get-jackpot-info**, т.к. он начнет показывать информацию о новой игре. метод получает информацию о результате игры.

|параметр|описание|
|--|--|
|url|url с которым запустилось приложение **(string)**|
|time|временная точка во время игры в формате unix-времени **(int)**|

*пояснение: в параметр time следует передать любое время из промежутка между концом прошлой игры и концом текущей. так бэк понимает какой именно результат нужно вернуть.* 

пример запроса:

    {
		"url": "https://site.com/?vk_user_id=494075&vk_app_id=6736218&vk_is_app_user=1&vk_are_notifications_enabled=1&vk_language=ru&vk_access_token_settings=&vk_platform=android&sign=t4WeyGcuTMSnKECxnjaBQrPBJgw3xNHzky7NcXyTcgI",
		"time": 1630503414
    }

|возвращаемое значение|описание|
|--|--|
|id|vkid пользователя **(int)**|
|is_player|участвует ли пользователь в этой игре **(bool)**|
|money|количество денег у пользователя **(int)**|
|bet|ставка пользователя **(int)**|
|pot|банк **(int)**|
|players_count|количество игроков **(int)**|
|start|время старта розыгрыша в unix **(int)**|
|chance|шанс выигрыша пользователя **(double)**|
|players|массив игроков для рулетки **(array)**|
|winner_id|vkid победителя **(int)**|
|offset|смещение в пикселях относительно начала блока **(int)**|

пример ответа:

    {
	    "id": 128334940,
	    "responce": "ok",
	    "money": 26005299997,
	    "bet": 50000,
	    "pot": 60000,
	    "players_count": 2,
	    "start": 1630251438,
	    "chance": 83.33,
	    "players": [128334940,123,123,123,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940,128334940]
    }

|ошибка|описание|обработка|
|--|--|--|
|code 800 *(invalid bet)*|неправильно указан параметр **time**|следует отправить соответствующее сообщение в console.log|
|code 801 *(result not found)*|результат игры не найдет|следует повторно обратиться к методу через некоторое время|

<a name="pay-salary"></a>
### pay-salary.php

вызывается, когда надо выдать зарплату админу.

|параметр|описание|
|--|--|
|to_id|vk id чела, которому выдаём зп **(int)**|
|sum|сумма, которую выдаем **(int)**|
|token|секретный ключ **(string)**|

пример запроса:

    {
		"to_id": 1630503414,
		"sum": 1000000000,
		"token": "ihncv39r8chew8dc7b2gc8ey0geub3g0e8ycg7f2e8ubcxg2e8yw"
    }

|возвращаемое значение|описание|
|--|--|
|responce|ok **(string)**|

пример ответа:

    {
	    "responce": "ok"
    }

|ошибка|описание|
|--|--|--|
|code 810 *(invalid to id)*|неправильно указан **to id**|
|code 811 *(invalid sum)*|неправильно указана сумма **(sum)**|
|code 812 *(limit)*|превышен лимит выдачи игроку|
|code 813 *(is not admin)*|указанный игрок не является админом|
